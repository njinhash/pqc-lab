# OpenSSL configuration for Intermediate Certificate Authority
# Module 03 - FIPS 203/204 (ML-DSA-87) Quantum-Resistant CA

[ ca ]
default_ca = CA_default

[ CA_default ]
# Directory and file locations
dir               = .
certs             = $dir/certs
crl_dir           = $dir/crl
new_certs_dir     = $dir/newcerts
database          = $dir/index.txt
serial            = $dir/serial
RANDFILE          = $dir/private/.rand

# The Intermediate CA private key and certificate
private_key = C:\\Users\\user\\Desktop\\PQC\\pqc-lab\\lab-work\\openssl-pqc-stepbystep-lab\\fipsqs\\03_fips_quantum_ca_intermediate\\intermediate\\private\\intermediate_ca.key
certificate       = $dir/certs/intermediate_ca.crt

# Certificate revocation
crl               = $dir/crl/intermediate_ca.crl.pem
crlnumber         = $dir/crlnumber
crl_extensions    = crl_ext

# Default expiration days
default_crl_days  = 30
default_days      = 1825  # 5 years validity for Intermediate CA

# Policy to use for certificate validation
policy            = intermediate_policy

[ intermediate_policy ]
# Less strict than root - allows more field variations
countryName             = supplied
stateOrProvinceName     = supplied
organizationName        = supplied
organizationalUnitName  = optional
commonName              = supplied
emailAddress            = optional

[ req ]
default_bits        = 2048  # Not used for ML-DSA-87, but required
string_mask         = utf8only
default_md          = sha256
distinguished_name  = req_distinguished_name
req_extensions      = v3_req

[ req_distinguished_name ]
countryName                     = Country Name (2 letter code)
countryName_default             = US
countryName_min                 = 2
countryName_max                 = 2
stateOrProvinceName             = State or Province Name
stateOrProvinceName_default     = Washington
localityName                    = Locality Name
localityName_default            = Seattle
0.organizationName              = Organization Name
0.organizationName_default      = My Quantum Lab
organizationalUnitName          = Organizational Unit Name
organizationalUnitName_default  = Post-Quantum Intermediate CA
commonName                      = Common Name
commonName_default              = Quantum Intermediate CA - ML-DSA-87
commonName_max                  = 64
emailAddress                    = Email Address
emailAddress_max                = 64

[ v3_req ]
basicConstraints = CA:TRUE, pathlen:0
keyUsage = keyCertSign, cRLSign
subjectKeyIdentifier = hash

[ v3_intermediate_ca ]
# Extensions for Intermediate CA certificate
subjectKeyIdentifier = hash
authorityKeyIdentifier = keyid:always,issuer
basicConstraints = critical, CA:TRUE, pathlen:0
keyUsage = critical, digitalSignature, keyCertSign, cRLSign

[ crl_ext ]
authorityKeyIdentifier = keyid:always

[ ocsp ]
basicConstraints = CA:FALSE
subjectKeyIdentifier = hash
authorityKeyIdentifier = keyid,issuer
keyUsage = critical, digitalSignature
extendedKeyUsage = critical, OCSPSigning
unique_subject = no


